#!/bin/sh

test_phonemes() {
	TEST_LANG=$1
	EXPECTED=$2
	TEST_TEXT=$3

	echo "testing ${TEST_LANG}"
	ESPEAK_DATA_PATH=`pwd` LD_LIBRARY_PATH=src:${LD_LIBRARY_PATH} \
		src/espeak-ng -xq -v ${TEST_LANG} "${TEST_TEXT}" > actual.txt
	echo "${EXPECTED}" > expected.txt
	diff expected.txt actual.txt || exit 1
}

test_phonemes de \
	" dr'Uk3 l'amp@ (en)k@mpj'u:t3(de) St'Ern St'Ern@" \
	"drucker lampe computer stern sterne"
test_phonemes en \
	" f'Ut str'Vt n'O@T f'o@s kj'U@ T'O:t l'0t kl'0T tr'ap b'aaT" \
	"foot strut north force cure thought lot cloth trap bath"
test_phonemes en-029 \
	" f'Ut str'Vt n'O@t[ f'o@s kj'o@ t['O:t l'0t kl'0t[ tr'ap b'aat[" \
	"foot strut north force cure thought lot cloth trap bath"
test_phonemes en-GB-scotland \
	" f'Ut str'Vt n'O@rT f'o@rs kj'U@ T'O:t l'0t kl'0T tr'ap b'aaT" \
	"foot strut north force cure thought lot cloth trap bath"
test_phonemes en-GB-x-gbclan \
	" f'Ut str'Vt n'O@T f'o@s kj'U@ T'O:t l'0t kl'0T tr'ap b'aaT" \
	"foot strut north force cure thought lot cloth trap bath"
test_phonemes en-GB-x-gbcwmd \
	" f'Ut str'Vt n'O@T f'O@s kj'U@ T'O:t l'0t kl'0T tr'ap b'aaT" \
	"foot strut north force cure thought lot cloth trap bath"
test_phonemes en-GB-x-rp \
	" f'Ut str'Vt n'O@T f'O@s kj'U@ T'O:t l'0t kl'0T tr'ap b'aaT" \
	"foot strut north force cure thought lot cloth trap bath"
test_phonemes en-US \
	" f'Ut str'Vt n'O@T f'o@s kj'U@ T'O:t l'0t kl'O2T tr'ap b'aaT" \
	"foot strut north force cure thought lot cloth trap bath"
test_phonemes ja \
	" k'a k'i k'u k'e k'o" \
	"か き く け こ"
test_phonemes lv \
	" nev'ie:na nuo\`_ 'eiRo:pas v'al>sti:m nek,ad nav p'a:Rga:jusi nuo\`_ 'univERsa:la:s_:_: nuo\` v'ispa:Re:jiem n'uoduok}l^iem f'inanse:tas_:_: s'iste:mas uz 'obliga:ta:s 'apdRuoSina:Sanas s'iste:mu b'eigas" \
	"Neviena no Eiropas valstīm nekad nav pārgājusi no universālās (no vispārējiem nodokļiem finansētas) sistēmas uz obligātās apdrošināšanas sistēmu Beigas."

# Languages with non-Latin characters fall back to en when speaking Latin characters.
# TODO: Include words in their native script and move to the main tests above.

test_phonemes bg \
	" (en)f'Ut str'Vt(bg)" \
	"foot strut"
test_phonemes fa \
	" (en)f'Ut str'Vt(fa)" \
	"foot strut"
test_phonemes ka \
	" (en)f'Ut str'Vt(ka)" \
	"foot strut"
