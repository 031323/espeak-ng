#!/bin/sh

test_replace() {
	TEST_LANG=$1
	TEST_TEXT=$2
	TEST_BROKEN=${3:-false}

	echo "testing ${TEST_LANG}"
	ESPEAK_DATA_PATH=`pwd` LD_LIBRARY_PATH=src:${LD_LIBRARY_PATH} \
		src/espeak-ng -Xq -v ${TEST_LANG} "${TEST_TEXT}" | grep -P "(Translate|Found:) " | sed -e 's/ \[.*][ ]*$//g' > actual.txt
	if [ x$TEST_BROKEN = xbroken ] ; then
		diff expected.txt actual.txt || (echo "... ignoring error (broken)" && true)
	else
		diff expected.txt actual.txt || exit 1
	fi
}

##### bs: Bosnian

# Ljubazni fenjerdžija čađavog lica hoće da mi pokaže štos.
cat > expected.txt <<EOF
Translate 'ljubazni'
Translate 'fenjerdžija'
Translate 'čađavog'
Translate 'lica'
Translate 'hoće'
Translate 'da'
Translate 'mi'
Translate 'pokaže'
Translate 'štos'
EOF
test_replace bs "Љубазни фењерџија чађавог лица хоће да ми покаже штос." broken

##### en: English

cat > expected.txt <<EOF
Translate 'aeon'
Found: 'mediaeval'
Translate 'oeconomy'
Found: 'phoenix'
EOF
test_replace en "Æon mediæval. Œconomy phœnix."

##### hr: Croatian

# Ljubazni fenjerdžija čađavog lica hoće da mi pokaže štos.
cat > expected.txt <<EOF
Translate 'ljubazni'
Translate 'fenjerdžija'
Translate 'čađavog'
Translate 'lica'
Translate 'hoće'
Translate 'da'
Translate 'mi'
Translate 'pokaže'
Translate 'štos'
EOF
test_replace hr "Љубазни фењерџија чађавог лица хоће да ми покаже штос." broken

##### sr: Serbian

# Ljubazni fenjerdžija čađavog lica hoće da mi pokaže štos.
cat > expected.txt <<EOF
Translate 'ljubazni'
Translate 'fenjerdžija'
Translate 'čađavog'
Translate 'lica'
Translate 'hoće'
Translate 'da'
Translate 'mi'
Translate 'pokaže'
Translate 'štos'
EOF
test_replace sr "Љубазни фењерџија чађавог лица хоће да ми покаже штос." broken

